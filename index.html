<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lavamex POS</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Import Map for React & Firebase -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.263.1",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"
      }
    }
    </script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useCallback } from 'react';
        import { createRoot } from 'react-dom/client';
        import { User, DollarSign, Car, CheckCircle, FileText, Settings, Trash2, LogOut, Users, Calculator, Printer, Wifi, WifiOff, Lock, Calendar, ToggleLeft, ToggleRight, Archive, Pencil, XCircle, PlusCircle, Coffee } from 'lucide-react';
        import { initializeApp, getApps, getApp } from 'firebase/app';
        import { getFirestore, collection, addDoc, updateDoc, doc, onSnapshot, query, orderBy, serverTimestamp, writeBatch } from 'firebase/firestore';

        // --- 1. CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyByIvJpBZv32Zd22fxlYWL9etzBa66Q2rE",
            authDomain: "poslavamex.firebaseapp.com",
            projectId: "poslavamex",
            storageBucket: "poslavamex.firebasestorage.app",
            messagingSenderId: "883264129",
            appId: "1:883264129:web:39a352e2ade3888b4f1b80"
        };

        // Initialize Firebase Singleton
        const app = !getApps().length ? initializeApp(firebaseConfig) : getApp();
        const db = getFirestore(app);

        // --- 2. CONSTANTS & DATA ---
        const SIZES = [
          { id: 'AUTO', label: 'Auto' },
          { id: 'SUV_CHICA', label: 'SUV Chica' },
          { id: 'PICKUP', label: 'Pick-Up' },
          { id: 'SUV_GDE', label: 'SUV Gde' },
        ];

        const SERVICES = [
          { id: 'GENERAL', label: 'Lavado General' },
          { id: 'WAX', label: 'Lavado + Cera' },
          { id: 'COMPLETE', label: 'Paquete Completo' },
          { id: 'PREMIUM', label: 'Paquete Premium' },
          { id: 'PRESIDENTIAL', label: 'Paquete Presidencial' },
        ];

        const EXTRAS = [
            { id: 'MOTOR', label: 'Lavado Motor', price: 400, commission: 140 },
            { id: 'CHASIS', label: 'Chasis', price: 150, commission: 52.50 },
            { id: 'AROMA', label: 'Aroma', price: 30, commission: 10.50 },
            { id: 'BOLEADA', label: 'Boleada', price: 50, commission: 17.50 },
            { id: 'TAPICERIA', label: 'Limpieza Tapicería', price: 600, commission: 210 },
        ];

        const SNACK_PRICE = 25;

        const PRICES = {
          GENERAL: { AUTO: 200, SUV_CHICA: 240, PICKUP: 360, SUV_GDE: 360 },
          WAX: { AUTO: 540, SUV_CHICA: 640, PICKUP: 820, SUV_GDE: 820 },
          COMPLETE: { AUTO: 840, SUV_CHICA: 1040, PICKUP: 1160, SUV_GDE: 1640 },
          PREMIUM: { AUTO: 1180, SUV_CHICA: 1440, PICKUP: 1620, SUV_GDE: 2100 },
          PRESIDENTIAL: { AUTO: 1540, SUV_CHICA: 1940, PICKUP: 2320, SUV_GDE: 2320 },
        };

        const COMMISSIONS = {
          GENERAL: { AUTO: 70, SUV_CHICA: 84, PICKUP: 126, SUV_GDE: 126 },
          WAX: { AUTO: 189, SUV_CHICA: 224, PICKUP: 287, SUV_GDE: 287 },
          COMPLETE: { AUTO: 294, SUV_CHICA: 364, PICKUP: 406, SUV_GDE: 574 },
          PREMIUM: { AUTO: 413, SUV_CHICA: 504, PICKUP: 567, SUV_GDE: 735 },
          PRESIDENTIAL: { AUTO: 539, SUV_CHICA: 679, PICKUP: 812, SUV_GDE: 812 },
        };

        const PRINT_STYLES = `
            @page { margin: 0; }
            body { font-family: 'Courier New', monospace; width: 58mm; margin: 0; padding: 5px; font-size: 12px; color: black; }
            .header { text-align: center; font-weight: bold; margin-bottom: 10px; }
            .title { font-size: 16px; font-weight: bold; display: block; margin-bottom: 5px;}
            .big-text { font-size: 18px; font-weight: bold; display: block; margin: 5px 0;}
            .divider { border-top: 1px dashed black; margin: 10px 0; }
            .item { display: flex; justify-content: space-between; margin-bottom: 3px; }
            .footer { text-align: center; margin-top: 15px; font-size: 10px; }
            .center { text-align: center; }
        `;

        // --- 3. UTILITIES & SERVICES ---

        const formatCurrency = (amount) => 
            new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(amount);

        const calculatePayroll = (employees, history, deductions) => {
            const payroll = {};
            employees.forEach(emp => {
                payroll[emp.name] = { count: 0, total: 0, details: [], deductionTotal: 0, netPay: 0 };
            });

            history.forEach(item => {
                const washersList = item.washers || (item.washer ? [item.washer] : []);
                if (washersList.length === 0) return;
                const splitCommission = item.commission / washersList.length;

                washersList.forEach(washerName => {
                    if (!payroll[washerName]) payroll[washerName] = { count: 0, total: 0, details: [], deductionTotal: 0, netPay: 0 };
                    payroll[washerName].count += 1;
                    payroll[washerName].total += splitCommission;
                    payroll[washerName].details.push(item);
                });
            });

            deductions.forEach(d => {
                if (payroll[d.employee]) payroll[d.employee].deductionTotal += d.amount;
            });

            Object.keys(payroll).forEach(key => {
                payroll[key].netPay = payroll[key].total - payroll[key].deductionTotal;
            });

            return payroll;
        };

        const PrintService = {
            printHtml: (content, styles = PRINT_STYLES) => {
                const win = window.open('', '', 'height=600,width=400');
                if (!win) return alert("Habilita ventanas emergentes para imprimir.");
                win.document.write(`<html><head><title>Print</title><style>${styles}</style></head><body>${content}</body></html>`);
                win.document.close();
                win.focus();
                setTimeout(() => { win.print(); win.close(); }, 500);
            },
            
            jobTicket: (ticket, shortId) => {
                const extrasHtml = (ticket.extras || []).map(ex => `<div>+ ${ex.label}</div>`).join('');
                const snacksHtml = ticket.snackCount > 0 ? `<div>+ Snacks (${ticket.snackCount})</div>` : '';
                const washers = ticket.washers ? ticket.washers.join(', ') : ticket.washer;

                PrintService.printHtml(`
                    <div class="header"><span class="title">LAVAMEX</span><span>ORDEN DE SERVICIO</span></div>
                    <div class="divider"></div>
                    <div class="item"><span>TICKET:</span> <strong>#${shortId}</strong></div>
                    <div class="item"><span>HORA:</span> <span>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span></div>
                    <div class="divider"></div>
                    <div class="center"><span>LAVADORES:</span><span class="big-text">${washers}</span></div>
                    <div class="divider"></div>
                    <div class="center">
                        <span class="big-text">${ticket.size.label}</span>
                        <span class="big-text">${ticket.service.label}</span>
                        ${extrasHtml ? `<div style="margin-top:5px; font-weight:bold;">${extrasHtml}</div>` : ''}
                        ${snacksHtml ? `<div style="margin-top:5px; font-weight:bold;">${snacksHtml}</div>` : ''}
                        ${ticket.vehicleDesc ? `<div style="margin-top:5px; font-weight:bold;">${ticket.vehicleDesc}</div>` : ''}
                    </div>
                    <div class="divider"></div>
                    <div class="footer">.. COLOCAR EN TABLERO ..</div>
                `);
            },

            receipt: (ticket, payment, shortId) => {
                const extrasHtml = (ticket.extras || []).map(ex => `<div class="item"><span>+ ${ex.label}</span><span>${formatCurrency(ex.price)}</span></div>`).join('');
                const snacksHtml = ticket.snackCount > 0 ? `<div class="item"><span>+ Snacks (${ticket.snackCount})</span><span>${formatCurrency(ticket.snackCount * SNACK_PRICE)}</span></div>` : '';
                const washers = ticket.washers ? ticket.washers.join(', ') : ticket.washer;

                PrintService.printHtml(`
                    <div class="header"><span class="title">LAVAMEX</span><span>COMPROBANTE DE PAGO</span></div>
                    <div class="divider"></div>
                    <div class="item"><span>FECHA:</span> <span>${new Date().toLocaleDateString()}</span></div>
                    <div class="item"><span>HORA:</span> <span>${new Date().toLocaleTimeString()}</span></div>
                    <div class="item"><span>TICKET:</span> <span>#${shortId}</span></div>
                    <div class="divider"></div>
                    <div class="item"><span>${ticket.service.label}</span></div>
                    <div class="item"><span>(${ticket.size.label})</span><span>${formatCurrency(PRICES[ticket.service.id][ticket.size.id])}</span></div>
                    ${extrasHtml} ${snacksHtml}
                    ${ticket.vehicleDesc ? `<div class="item" style="font-size:10px; font-style:italic;"><span>${ticket.vehicleDesc}</span></div>` : ''}
                    <div class="divider"></div>
                    <div class="item" style="font-weight:bold;"><span>TOTAL:</span> <span>${formatCurrency(ticket.price)}</span></div>
                    <div class="divider"></div>
                    <div class="item"><span>Efectivo MXN:</span> <span>${formatCurrency(payment.mxn)}</span></div>
                    <div class="item"><span>Efectivo USD:</span> <span>$${payment.usd.toFixed(2)}</span></div>
                    <div class="item" style="font-size:10px;"><span>(Rate: $${payment.rate})</span></div>
                    <div class="item" style="margin-top:5px;"><span>CAMBIO:</span> <span>${formatCurrency(payment.change)}</span></div>
                    <div class="footer">¡GRACIAS POR SU PREFERENCIA!<br/>Atendido por: ${washers}</div>
                `);
            },

            // For full page reports (Attendance/Payroll) we use different styles
            report: (htmlContent) => {
                const styles = `
                    @page { size: auto; margin: 20mm; }
                    body { font-family: sans-serif; font-size: 12px; color: #333; }
                    .payslip { border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; page-break-after: always; }
                    .header { text-align: center; border-bottom: 2px solid #333; margin-bottom: 15px; padding-bottom: 10px; }
                    .company { font-size: 20px; font-weight: bold; }
                    .report-title { font-size: 16px; margin-top: 5px; }
                    .emp-info { font-size: 16px; font-weight: bold; margin-bottom: 10px; display: flex; justify-content: space-between; }
                    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                    th, td { border: 1px solid #ddd; padding: 6px 8px; text-align: left; }
                    th { background-color: #f2f2f2; font-weight: bold; }
                    .text-right { text-align: right; }
                    .total-row { font-weight: bold; background-color: #e6e6e6; }
                    .day-header { background-color: #f9f9f9; font-weight: bold; font-style: italic; }
                    .footer { margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; text-align: center; font-size: 10px; }
                    /* Attendance specific */
                    th.emp-col { text-align: left; width: 150px; }
                    th.day-col { width: 25px; font-size: 10px; text-align: center; }
                    .present { color: green; font-weight: bold; text-align: center; }
                    .absent { color: #ddd; text-align: center; }
                `;
                const win = window.open('', '', 'height=800,width=1000');
                if (!win) return alert("Popups blocked.");
                win.document.write(`<html><head><title>Report</title><style>${styles}</style></head><body>${htmlContent}</body></html>`);
                win.document.close();
                win.focus();
                setTimeout(() => { win.print(); win.close(); }, 500);
            }
        };

        // --- 4. COMPONENTS ---

        const GreeterView = ({ 
            employees, selectedSize, setSelectedSize, 
            selectedService, setSelectedService, 
            selectedWashers, setSelectedWashers, 
            selectedExtras, setSelectedExtras,
            snackCount, setSnackCount,
            vehicleDesc, setVehicleDesc,
            createTicket, isEditing, cancelEdit
        }) => {
            const activeEmployees = employees.filter(e => e.active);
            
            const toggleItem = (list, item, setList) => {
                // For arrays of objects (extras) or strings (washers)
                const exists = typeof item === 'string' 
                    ? list.includes(item) 
                    : list.some(i => i.id === item.id);
                
                if (exists) {
                    setList(list.filter(i => (typeof item === 'string' ? i !== item : i.id !== item.id)));
                } else {
                    setList([...list, item]);
                }
            };

            const basePrice = (selectedSize && selectedService) ? PRICES[selectedService.id][selectedSize.id] : 0;
            const extrasPrice = selectedExtras.reduce((sum, e) => sum + e.price, 0);
            const totalPrice = basePrice + extrasPrice; // Snacks are separate/cashier only

            return (
                <div className="flex flex-col h-full relative">
                    {isEditing && (
                        <div className="bg-yellow-100 border-b border-yellow-300 p-2 text-center text-yellow-800 font-bold flex justify-between items-center px-4">
                            <span>✏️ EDITANDO TICKET EXISTENTE</span>
                            <button onClick={cancelEdit} className="text-sm underline text-yellow-900">Cancelar</button>
                        </div>
                    )}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 h-full overflow-auto p-4">
                        <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                            <h3 className="font-bold text-gray-700 mb-4 flex items-center"><Car className="w-5 h-5 mr-2"/> 1. Tamaño</h3>
                            <div className="space-y-2">
                                {SIZES.map(size => (
                                    <button key={size.id} onClick={() => setSelectedSize(size)} className={`w-full p-3 text-left rounded-lg border-2 transition-all ${selectedSize?.id === size.id ? 'border-blue-600 bg-blue-50 text-blue-700 font-bold' : 'border-gray-200 hover:border-gray-300'}`}>{size.label}</button>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                            <h3 className="font-bold text-gray-700 mb-4 flex items-center"><FileText className="w-5 h-5 mr-2"/> 2. Servicio</h3>
                            <div className="space-y-2">
                                {SERVICES.map(service => (
                                    <button key={service.id} onClick={() => setSelectedService(service)} disabled={!selectedSize} className={`w-full p-3 text-left rounded-lg border-2 transition-all flex justify-between ${!selectedSize ? 'opacity-50' : selectedService?.id === service.id ? 'border-blue-600 bg-blue-50 text-blue-700 font-bold' : 'border-gray-200 hover:border-gray-300'}`}>
                                        <span>{service.label}</span>
                                        {selectedSize && <span className="text-sm">${PRICES[service.id][selectedSize.id]}</span>}
                                    </button>
                                ))}
                            </div>
                            <div className="mt-6 pt-4 border-t">
                                <h3 className="font-bold text-gray-700 mb-2 flex items-center"><PlusCircle className="w-5 h-5 mr-2"/> Extras</h3>
                                <div className="space-y-2">
                                    {EXTRAS.map(extra => (
                                        <button key={extra.id} onClick={() => toggleItem(selectedExtras, extra, setSelectedExtras)} className={`w-full p-2 text-left rounded-lg border-2 transition-all flex justify-between text-sm ${selectedExtras.some(e => e.id === extra.id) ? 'border-indigo-600 bg-indigo-50 text-indigo-700 font-bold' : 'border-gray-200 hover:border-gray-300'}`}>
                                            <span>{extra.label}</span><span>+${extra.price}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="md:col-span-2 bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex flex-col">
                            <h3 className="font-bold text-gray-700 mb-4 flex items-center"><User className="w-5 h-5 mr-2"/> 3. Lavadores ({selectedWashers.length})</h3>
                            <div className="grid grid-cols-2 gap-2 mb-6">
                                {activeEmployees.map(emp => (
                                    <button key={emp.name} onClick={() => toggleItem(selectedWashers, emp.name, setSelectedWashers)} className={`p-3 text-center rounded-lg border-2 transition-all ${selectedWashers.includes(emp.name) ? 'border-green-600 bg-green-50 text-green-700 font-bold shadow-inner' : 'border-gray-200 hover:border-gray-300'}`}>
                                        {emp.name} {selectedWashers.includes(emp.name) && '✓'}
                                    </button>
                                ))}
                            </div>
                            <div className="mt-auto bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <div className="mb-4">
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Descripción (Opcional)</label>
                                    <input type="text" value={vehicleDesc} onChange={(e) => setVehicleDesc(e.target.value)} placeholder="Ej. Mazda Gris" className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"/>
                                </div>
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-gray-800 font-bold text-lg">Total a Pagar (Base):</span>
                                    <span className="text-3xl font-bold text-gray-900">{formatCurrency(totalPrice)}</span>
                                </div>
                                <button onClick={createTicket} disabled={!selectedSize || !selectedService || selectedWashers.length === 0} className={`w-full py-4 rounded-xl font-bold text-white shadow-lg transition-transform active:scale-95 flex items-center justify-center ${!selectedSize || !selectedService || selectedWashers.length === 0 ? 'bg-gray-300 cursor-not-allowed' : (isEditing ? 'bg-yellow-600 hover:bg-yellow-700' : 'bg-blue-600 hover:bg-blue-700')}`}>
                                    {isEditing ? <><Pencil className="w-5 h-5 mr-2"/> ACTUALIZAR ORDEN</> : <><Printer className="w-5 h-5 mr-2"/> CREAR ORDEN</>}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const CashierView = ({ 
            tickets, activeTicketId, setActiveTicketId, paymentMxn, setPaymentMxn, paymentUsd, setPaymentUsd, 
            exchangeRate, processPayment, deleteTicket, startEdit, updateTicketSnacks, employees, addEmployeeDebt 
        }) => {
            const selectedTicket = tickets.find(t => t.id === activeTicketId);
            const [showEmpSnackModal, setShowEmpSnackModal] = useState(false);
            const [empSnackName, setEmpSnackName] = useState('');
            const [empSnackCount, setEmpSnackCount] = useState(1);

            return (
              <div className="flex h-full gap-6 p-4 relative">
                <div className="absolute top-4 right-4 z-10">
                    <button onClick={() => setShowEmpSnackModal(true)} className="bg-orange-100 text-orange-700 border border-orange-300 px-4 py-2 rounded-lg font-bold flex items-center hover:bg-orange-200"><Coffee className="w-4 h-4 mr-2"/> Snack Empleado</button>
                </div>

                {showEmpSnackModal && (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
                        <div className="bg-white p-6 rounded-xl shadow-2xl w-96">
                            <h3 className="text-xl font-bold mb-4 flex items-center"><Coffee className="w-6 h-6 mr-2 text-orange-500"/> Venta a Empleado</h3>
                            <div className="mb-4">
                                <label className="block text-sm font-bold text-gray-700 mb-2">Empleado</label>
                                <select className="w-full border p-2 rounded-lg" value={empSnackName} onChange={e => setEmpSnackName(e.target.value)}>
                                    <option value="">Seleccionar...</option>
                                    {employees.map(e => <option key={e.name} value={e.name}>{e.name}</option>)}
                                </select>
                            </div>
                            <div className="mb-6">
                                <div className="flex items-center border rounded-lg">
                                    <button onClick={() => setEmpSnackCount(Math.max(1, empSnackCount - 1))} className="px-4 py-2 bg-gray-100 font-bold">-</button>
                                    <div className="flex-1 text-center font-bold text-lg">{empSnackCount}</div>
                                    <button onClick={() => setEmpSnackCount(empSnackCount + 1)} className="px-4 py-2 bg-gray-100 font-bold">+</button>
                                </div>
                                <div className="text-center mt-2 font-bold text-orange-600">Total: {formatCurrency(empSnackCount * SNACK_PRICE)}</div>
                            </div>
                            <div className="flex gap-2">
                                <button onClick={() => setShowEmpSnackModal(false)} className="flex-1 border p-2 rounded-lg text-gray-600 hover:bg-gray-50">Cancelar</button>
                                <button onClick={() => { 
                                    if(!empSnackName) return; 
                                    addEmployeeDebt(empSnackName, empSnackCount); 
                                    setShowEmpSnackModal(false); 
                                    setEmpSnackCount(1); 
                                    setEmpSnackName(''); 
                                }} className="flex-1 bg-orange-600 text-white p-2 rounded-lg font-bold hover:bg-orange-700">Confirmar</button>
                            </div>
                        </div>
                    </div>
                )}

                <div className="w-1/3 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col">
                  <div className="p-4 border-b bg-gray-50 font-bold text-gray-700">Tickets Activos ({tickets.length})</div>
                  <div className="overflow-auto flex-1 p-2 space-y-2">
                    {tickets.map(ticket => (
                      <div key={ticket.id} onClick={() => setActiveTicketId(ticket.id)} className={`p-3 rounded-lg border cursor-pointer hover:shadow-md transition-all ${activeTicketId === ticket.id ? 'border-blue-500 bg-blue-50 ring-1 ring-blue-500' : 'border-gray-200 bg-white'}`}>
                        <div className="flex justify-between items-start mb-1"><span className="font-bold text-gray-800">#{ticket.id.slice(-4).toUpperCase()}</span><span className="text-xs font-semibold bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full">{ticket.size.label}</span></div>
                        <div className="text-sm text-gray-600">{ticket.service.label} {ticket.snackCount > 0 && <span className="text-orange-600 font-bold">+ Snacks</span>}</div>
                        <div className="flex justify-between items-center mt-2"><span className="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded truncate max-w-[120px]">{ticket.washers ? ticket.washers.join(', ') : ticket.washer}</span><span className="font-bold text-blue-600">{formatCurrency(ticket.price)}</span></div>
                      </div>
                    ))}
                  </div>
                </div>
                
                <div className="flex-1 bg-white rounded-xl shadow-sm border border-gray-200 p-8 flex flex-col justify-center items-center">
                  {!selectedTicket ? <div className="text-gray-400 flex flex-col items-center"><LogOut className="w-16 h-16 mb-4 opacity-20"/><p>Selecciona un ticket</p></div> : (
                    <div className="w-full max-w-md">
                      <div className="text-center mb-6">
                          <h2 className="text-3xl font-bold text-gray-800 mb-1">{formatCurrency(selectedTicket.price)} MXN</h2>
                          <p className="text-gray-500">#{selectedTicket.id.slice(-4).toUpperCase()} • {selectedTicket.washers ? selectedTicket.washers.join(', ') : selectedTicket.washer}</p>
                          {selectedTicket.vehicleDesc && <p className="text-lg font-bold text-blue-700 mt-2 bg-blue-50 py-1 px-3 rounded inline-block">{selectedTicket.vehicleDesc}</p>}
                          
                          <div className="mt-4 flex items-center justify-center gap-2 bg-orange-50 p-2 rounded-lg border border-orange-100">
                              <span className="text-sm font-bold text-orange-800"><Coffee className="inline w-4 h-4 mr-1"/>Cliente Snacks:</span>
                              <button onClick={() => updateTicketSnacks(selectedTicket.id, Math.max(0, (selectedTicket.snackCount || 0) - 1))} className="w-8 h-8 bg-white rounded shadow text-gray-600 font-bold hover:bg-gray-100">-</button>
                              <span className="font-bold w-6 text-center">{selectedTicket.snackCount || 0}</span>
                              <button onClick={() => updateTicketSnacks(selectedTicket.id, (selectedTicket.snackCount || 0) + 1)} className="w-8 h-8 bg-white rounded shadow text-green-600 font-bold hover:bg-gray-100">+</button>
                          </div>
                      </div>

                      <div className="grid grid-cols-2 gap-4 mb-6">
                        <div><label className="block text-sm font-medium text-gray-700 mb-1">Efectivo MXN</label><input type="number" value={paymentMxn} onChange={e => setPaymentMxn(e.target.value)} className="w-full p-2 border rounded-lg" placeholder="0.00"/></div>
                        <div><label className="block text-sm font-medium text-gray-700 mb-1">Efectivo USD</label><input type="number" value={paymentUsd} onChange={e => setPaymentUsd(e.target.value)} className="w-full p-2 border rounded-lg" placeholder="0.00"/><div className="text-xs text-right text-gray-500 mt-1">Rate: ${exchangeRate}</div></div>
                      </div>
                      <div className="bg-gray-50 p-4 rounded-lg mb-6 text-sm">
                         <div className="flex justify-between font-bold text-lg"><span>Cambio:</span><span className={((parseFloat(paymentMxn)||0) + ((parseFloat(paymentUsd)||0)*exchangeRate) - selectedTicket.price) < 0 ? 'text-red-500' : 'text-green-600'}>{formatCurrency(((parseFloat(paymentMxn)||0) + ((parseFloat(paymentUsd)||0)*exchangeRate)) - selectedTicket.price)}</span></div>
                      </div>
                      <div className="flex gap-3">
                         <button type="button" onClick={() => deleteTicket(selectedTicket.id)} className="p-4 rounded-xl border border-red-200 text-red-500 hover:bg-red-50" title="Cancelar"><Trash2 className="w-5 h-5"/></button>
                         <button type="button" onClick={() => startEdit(selectedTicket)} className="p-4 rounded-xl border border-yellow-200 text-yellow-600 hover:bg-yellow-50" title="Editar"><Pencil className="w-5 h-5"/></button>
                         <button type="button" onClick={processPayment} disabled={((parseFloat(paymentMxn)||0) + ((parseFloat(paymentUsd)||0)*exchangeRate)) < selectedTicket.price} className={`flex-1 py-4 rounded-xl font-bold text-white shadow-lg flex items-center justify-center ${((parseFloat(paymentMxn)||0) + ((parseFloat(paymentUsd)||0)*exchangeRate)) < selectedTicket.price ? 'bg-gray-300 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700'}`}><Printer className="w-5 h-5 mr-2"/> COBRAR</button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
        };

        const PayrollView = ({ employees, history, deductions, db }) => {
            const payrollData = calculatePayroll(employees, history.filter(t => t.status === 'PAID'), deductions);
            const [showAuth, setShowAuth] = useState(false);
            const [password, setPassword] = useState('');
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [startDate, setStartDate] = useState(() => { const d = new Date(); d.setDate(d.getDate() - 7); return d.toISOString().split('T')[0]; });
            const [endDate, setEndDate] = useState(new Date().toISOString().split('T')[0]);

            const handleLogin = () => { if (password === '1234') { setIsAuthenticated(true); setPassword(''); } else { alert("Error"); } };

            const handlePrintReport = () => {
                 // Pass deductions to the printing service
                 const filteredHistory = history.filter(t => t.status === 'PAID');
                 // Create HTML for report
                 let reportHtml = `
                    <div style="text-align:center; font-weight:bold; font-size:16px; margin-bottom:10px;">LAVAMEX NOMINA</div>
                    <div style="text-align:center; margin-bottom:20px;">${startDate} - ${endDate}</div>
                 `;
                 
                 // Reuse calculation logic specifically for the range
                 // Filter history by date
                 const start = new Date(startDate + "T00:00:00");
                 const end = new Date(endDate + "T23:59:59");
                 const rangeHistory = filteredHistory.filter(item => {
                     const d = item.timestamp instanceof Date ? item.timestamp : new Date(item.timestamp);
                     return d >= start && d <= end;
                 });
                 const rangeDeductions = deductions.filter(item => {
                     const d = item.timestamp instanceof Date ? item.timestamp : new Date(item.timestamp);
                     return d >= start && d <= end;
                 });
                 
                 const rangePayroll = calculatePayroll(employees, rangeHistory, rangeDeductions);
                 
                 Object.keys(rangePayroll).forEach(emp => {
                     const data = rangePayroll[emp];
                     if(data.count === 0 && data.deductionTotal === 0) return;
                     
                     reportHtml += `
                        <div style="border:1px solid #ccc; padding:10px; margin-bottom:15px; page-break-inside:avoid;">
                            <div style="font-weight:bold; font-size:14px; border-bottom:1px solid #eee; padding-bottom:5px;">${emp}</div>
                            <table style="width:100%; font-size:12px; margin-top:5px;">
                                <tr><td>Servicios (${data.count}):</td><td style="text-align:right;">${formatCurrency(data.total)}</td></tr>
                                ${data.deductionTotal > 0 ? `<tr style="color:red;"><td>Descuentos:</td><td style="text-align:right;">-${formatCurrency(data.deductionTotal)}</td></tr>` : ''}
                                <tr style="font-weight:bold; font-size:14px;"><td>NETO:</td><td style="text-align:right;">${formatCurrency(data.netPay)}</td></tr>
                            </table>
                            <div style="margin-top:20px; border-top:1px solid #000; padding-top:5px; font-size:10px; text-align:center;">Firma Recibido</div>
                        </div>
                     `;
                 });
                 PrintService.report(reportHtml);
            };

            const resetPayroll = async () => {
                if(!db) return alert("Error");
                if(!confirm("¿Archivar semana actual y reiniciar contadores?")) return;
                
                const paidTickets = history.filter(t => t.status === 'PAID');
                const pendingDeductions = deductions.filter(d => d.status === 'PENDING');
                
                if (paidTickets.length === 0 && pendingDeductions.length === 0) return alert("Nada que archivar.");

                const batch = writeBatch(db);
                // Archive tickets
                paidTickets.forEach(t => batch.update(doc(db, "tickets", t.id), { status: 'ARCHIVED' }));
                // Archive deductions
                pendingDeductions.forEach(d => batch.update(doc(db, "deductions", d.id), { status: 'ARCHIVED' }));

                try { await batch.commit(); alert("Semana cerrada."); } catch (e) { alert("Error: " + e.message); }
            };

            return (
              <div className="p-8 max-w-5xl mx-auto">
                <div className="flex justify-between items-center mb-6">
                    <h2 className="text-2xl font-bold text-gray-800 flex items-center"><DollarSign className="w-6 h-6 mr-2 text-green-600"/> Reporte de Nómina</h2>
                    {!isAuthenticated ? 
                        <button onClick={() => setShowAuth(!showAuth)} className="bg-gray-800 text-white px-4 py-2 rounded-lg flex items-center gap-2"><Lock className="w-4 h-4" /> Admin</button> : 
                        <button onClick={() => {setIsAuthenticated(false); setShowAuth(false);}} className="bg-red-600 text-white px-4 py-2 rounded-lg"><Lock className="w-4 h-4" /> Salir</button>
                    }
                </div>

                {showAuth && !isAuthenticated && (
                    <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-6 max-w-md mx-auto flex gap-2">
                        <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} className="border p-2 rounded w-full" placeholder="PIN"/>
                        <button onClick={handleLogin} className="bg-blue-600 text-white px-4 py-2 rounded font-bold">Entrar</button>
                    </div>
                )}

                {isAuthenticated && (
                    <div className="space-y-6 mb-8">
                         <div className="bg-green-50 p-6 rounded-xl shadow-inner border border-green-200">
                            <h3 className="font-bold text-green-800 text-lg mb-4"><Printer className="inline w-5 h-5 mr-2"/> Reporte PDF</h3>
                            <div className="flex flex-wrap gap-4 items-end">
                                <div><label className="block text-sm font-bold">Inicio</label><input type="date" value={startDate} onChange={e => setStartDate(e.target.value)} className="p-2 border rounded"/></div>
                                <div><label className="block text-sm font-bold">Fin</label><input type="date" value={endDate} onChange={e => setEndDate(e.target.value)} className="p-2 border rounded"/></div>
                                <button onClick={handlePrintReport} className="bg-green-600 text-white px-6 py-2.5 rounded-lg font-bold shadow hover:bg-green-700">Imprimir Nómina</button>
                            </div>
                         </div>
                         <div className="bg-red-50 p-6 rounded-xl shadow-inner border border-red-200">
                           <h3 className="font-bold text-red-800 mb-2"><Archive className="inline w-5 h-5 mr-2"/> Cierre de Semana</h3>
                           <p className="text-sm text-red-700 mb-4">Archiva tickets pagados y deudas pendientes. Reinicia contadores a $0.</p>
                           <button onClick={resetPayroll} className="w-full bg-red-600 text-white px-4 py-3 rounded-lg font-bold hover:bg-red-700 flex justify-center items-center gap-2"><Archive className="w-4 h-4"/> CERRAR SEMANA</button>
                       </div>
                    </div>
                )}

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                   {Object.keys(payrollData).map(empName => {
                       const data = payrollData[empName];
                       return (
                         <div key={empName} className="bg-white p-6 rounded-xl shadow-sm border border-gray-200 relative overflow-hidden">
                           <div className="text-sm text-gray-500 uppercase tracking-wider font-bold mb-1">{empName}</div>
                           <div className="text-3xl font-bold text-green-700">{formatCurrency(data.netPay)}</div>
                           <div className="text-xs text-gray-400 mt-2 font-mono">
                               Comisión: {formatCurrency(data.total)} <br/>
                               <span className="text-red-400">Deuda: -{formatCurrency(data.deductionTotal)}</span>
                           </div>
                           <div className="absolute top-0 right-0 bg-gray-100 px-2 py-1 text-xs font-bold text-gray-500">{data.count} Autos</div>
                         </div>
                       );
                   })}
                </div>
              </div>
            );
        };

        const AdminView = ({ isOnline, db, exchangeRate, setExchangeRate, employees, setEmployees, history }) => {
            const [reportMonth, setReportMonth] = useState(new Date().toISOString().slice(0, 7));
            
            const handlePrintAttendance = () => {
                 const [year, month] = reportMonth.split('-');
                 const daysInMonth = new Date(year, month, 0).getDate();
                 let html = `<h2 style="text-align:center">Asistencia ${reportMonth}</h2><table border="1" cellspacing="0" cellpadding="5" style="width:100%; font-size:10px;"><thead><tr><th>Emp</th>`;
                 for(let i=1; i<=daysInMonth; i++) html += `<th>${i}</th>`;
                 html += `<th>Total</th></tr></thead><tbody>`;

                 employees.forEach(emp => {
                     let total = 0;
                     html += `<tr><td>${emp.name}</td>`;
                     for(let i=1; i<=daysInMonth; i++) {
                         const worked = history.some(t => {
                             const d = t.timestamp instanceof Date ? t.timestamp : new Date(t.timestamp);
                             const washers = t.washers || [t.washer];
                             return washers.includes(emp.name) && d.getDate() === i && d.getMonth()+1 === parseInt(month) && d.getFullYear() === parseInt(year);
                         });
                         if(worked) total++;
                         html += `<td style="text-align:center; color:${worked?'green':'#ccc'}">${worked?'✓':'.'}</td>`;
                     }
                     html += `<td style="font-weight:bold; text-align:center;">${total}</td></tr>`;
                 });
                 html += `</tbody></table>`;
                 PrintService.report(html);
            };

            const toggleEmployee = (idx) => {
                const newEmps = [...employees];
                newEmps[idx].active = !newEmps[idx].active;
                setEmployees(newEmps);
            };
            
            const addEmployee = () => {
                const val = document.getElementById('newEmp').value;
                if(val) { setEmployees([...employees, {name: val, active: true}]); document.getElementById('newEmp').value=''; }
            }

            return (
             <div className="p-8 max-w-2xl mx-auto">
               <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6">
                 <h3 className="font-bold text-gray-700 mb-4">Configuración</h3>
                 <div className="mb-4"><label>Tipo de Cambio</label><input type="number" value={exchangeRate} onChange={(e) => setExchangeRate(parseFloat(e.target.value))} className="border rounded p-2 ml-2"/></div>
                 <div className="flex gap-2 items-center"><label>Reporte Asistencia:</label><input type="month" value={reportMonth} onChange={e => setReportMonth(e.target.value)} className="border rounded p-1"/><button onClick={handlePrintAttendance} className="bg-indigo-600 text-white px-3 py-1 rounded">Imprimir</button></div>
               </div>
               <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                  <h3 className="font-bold text-gray-700 mb-4">Empleados</h3>
                  <div className="space-y-2">
                    {employees.map((emp, i) => (
                         <div key={i} className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                           <div className="flex items-center gap-3">
                               <button onClick={() => toggleEmployee(i)}>{emp.active ? <ToggleRight className="text-green-600"/> : <ToggleLeft className="text-gray-400"/>}</button>
                               <span className={emp.active ? "" : "text-gray-400 line-through"}>{emp.name}</span>
                           </div>
                           <button onClick={() => setEmployees(employees.filter((_, idx) => idx !== i))} className="text-red-500"><Trash2 className="w-4 h-4"/></button>
                         </div>
                    ))}
                  </div>
                  <div className="flex gap-2 mt-4 pt-4 border-t"><input type="text" id="newEmp" placeholder="Nuevo" className="border rounded p-2 flex-1"/><button onClick={addEmployee} className="bg-blue-600 text-white px-4 py-2 rounded">Agregar</button></div>
               </div>
             </div>
            );
        };

        // --- MAIN APP ---

        function App() {
          const [view, setView] = useState('GREETER');
          const [exchangeRate, setExchangeRate] = useState(18.10);
          const [editingTicketId, setEditingTicketId] = useState(null);
          const [employees, setEmployees] = useState([
              { name: 'Aldo', active: true }, { name: 'Sergio', active: true }, { name: 'Juan', active: true }, { name: 'Rodrigo', active: true }
          ]);
          const [tickets, setTickets] = useState([]);
          const [history, setHistory] = useState([]);
          const [deductions, setDeductions] = useState([]);
          const [isOnline, setIsOnline] = useState(navigator.onLine);

          useEffect(() => {
            const handleStatusChange = () => setIsOnline(navigator.onLine);
            window.addEventListener('online', handleStatusChange);
            window.addEventListener('offline', handleStatusChange);
            return () => { window.removeEventListener('online', handleStatusChange); window.removeEventListener('offline', handleStatusChange); };
          }, []);

          useEffect(() => {
            if (!db) return;
            const unsubTickets = onSnapshot(query(collection(db, "tickets"), orderBy("timestamp", "desc")), (snapshot) => {
                const ft = [], fh = [];
                snapshot.forEach(doc => {
                    const d = doc.data();
                    const item = { id: doc.id, ...d, timestamp: d.timestamp?.toDate ? d.timestamp.toDate() : d.timestamp };
                    if (item.status === 'PENDING') ft.push(item);
                    else if (item.status === 'PAID' || item.status === 'ARCHIVED') fh.push(item);
                });
                setTickets(ft); setHistory(fh);
            });
            const unsubDeductions = onSnapshot(query(collection(db, "deductions"), orderBy("timestamp", "desc")), (snapshot) => {
                const fd = [];
                snapshot.forEach(doc => {
                    const d = doc.data();
                    if(d.status === 'PENDING') fd.push({ id: doc.id, ...d, timestamp: d.timestamp?.toDate ? d.timestamp.toDate() : d.timestamp });
                });
                setDeductions(fd);
            });
            return () => { unsubTickets(); unsubDeductions(); };
          }, []);

          const [selectedSize, setSelectedSize] = useState(null);
          const [selectedService, setSelectedService] = useState(null);
          const [selectedWashers, setSelectedWashers] = useState([]); 
          const [selectedExtras, setSelectedExtras] = useState([]);
          const [vehicleDesc, setVehicleDesc] = useState('');
          const [activeTicketId, setActiveTicketId] = useState(null);
          const [paymentMxn, setPaymentMxn] = useState('');
          const [paymentUsd, setPaymentUsd] = useState('');

          const startEdit = (ticket) => {
            setSelectedSize(ticket.size); setSelectedService(ticket.service); setSelectedWashers(ticket.washers || (ticket.washer ? [ticket.washer] : []));
            setSelectedExtras(ticket.extras || []); setVehicleDesc(ticket.vehicleDesc || '');
            setEditingTicketId(ticket.id); setView('GREETER');
          };

          const cancelEdit = () => {
            setEditingTicketId(null); setSelectedSize(null); setSelectedService(null);
            setSelectedWashers([]); setSelectedExtras([]); setVehicleDesc('');
          };

          const saveTicket = async () => {
            if (!selectedSize || !selectedService || selectedWashers.length === 0) return;
            if (!db) return alert("Offline");
            
            const basePrice = PRICES[selectedService.id][selectedSize.id];
            const extrasPrice = selectedExtras.reduce((sum, e) => sum + e.price, 0);
            const baseCommission = COMMISSIONS[selectedService.id][selectedSize.id];
            const extrasCommission = selectedExtras.reduce((sum, e) => sum + e.commission, 0);
            
            // NOTE: We don't touch snacks here, they are cashier only.
            // When editing, we need to preserve existing snack count? Ideally yes, but simpler to just not touch it in update.
            // However, price needs to include snacks. 
            // Simplified: New tickets have 0 snacks. Edits will effectively reset snacks if we overwrite price without reading it. 
            // Fixed logic: We don't read prior state easily here. 
            // Constraint: User said "remove snacks from entrada". 
            // Assumption: Edit resets snacks to 0 or we need to read from `editingTicketId`.
            // Let's assume reset for simplicity or fix by reading ticket from `tickets` state.
            let currentSnacks = 0;
            if (editingTicketId) {
                const t = tickets.find(t => t.id === editingTicketId);
                if (t) currentSnacks = t.snackCount || 0;
            }

            const totalPrice = basePrice + extrasPrice + (currentSnacks * SNACK_PRICE);
            
            const data = {
                timestamp: serverTimestamp(),
                size: selectedSize, service: selectedService, washers: selectedWashers, extras: selectedExtras,
                price: totalPrice, commission: baseCommission + extrasCommission,
                vehicleDesc: vehicleDesc || '', status: 'PENDING', snackCount: currentSnacks
            };

            try {
                if (editingTicketId) {
                    await updateDoc(doc(db, "tickets", editingTicketId), data);
                    alert("Actualizado"); setEditingTicketId(null);
                } else {
                    const ref = await addDoc(collection(db, "tickets"), data);
                    PrintService.jobTicket(data, ref.id.slice(-4).toUpperCase());
                    alert("Enviado a Caja");
                }
                cancelEdit();
            } catch (e) { alert("Error"); }
          };

          const updateTicketSnacks = async (id, count) => {
              const t = tickets.find(x => x.id === id);
              if(!t || !db) return;
              const base = PRICES[t.service.id][t.size.id];
              const ext = (t.extras||[]).reduce((a,b)=>a+b.price,0);
              await updateDoc(doc(db, "tickets", id), { snackCount: count, price: base + ext + (count * SNACK_PRICE) });
          };

          const addEmployeeDebt = async (name, count) => {
              if(!db) return;
              await addDoc(collection(db, "deductions"), { timestamp: serverTimestamp(), employee: name, amount: count * SNACK_PRICE, description: `Snack (${count})`, status: 'PENDING' });
              alert("Venta registrada");
          };

          const processPayment = async () => {
              const t = tickets.find(x => x.id === activeTicketId);
              if(!t || !db) return;
              const mxn = parseFloat(paymentMxn)||0;
              const usd = parseFloat(paymentUsd)||0;
              if (mxn + (usd * exchangeRate) < t.price) return alert("Faltan fondos");
              
              const payDetails = { mxn, usd, rate: exchangeRate, total: mxn + (usd * exchangeRate), change: (mxn + (usd * exchangeRate)) - t.price };
              
              await updateDoc(doc(db, "tickets", t.id), { status: 'PAID', paidAt: serverTimestamp(), paymentDetails: payDetails });
              PrintService.receipt(t, payDetails, t.id.slice(-4).toUpperCase());
              setActiveTicketId(null); setPaymentMxn(''); setPaymentUsd('');
          };

          const deleteTicket = async (id) => {
              if(!db) return;
              if(confirm("¿Cancelar ticket?")) {
                  setTickets(prev => prev.filter(t => t.id !== id)); // Optimistic
                  if(activeTicketId === id) setActiveTicketId(null);
                  await updateDoc(doc(db, "tickets", id), { status: 'CANCELLED', cancelledAt: serverTimestamp() });
              }
          };

          return (
            <div className="bg-gray-100 h-screen flex flex-col font-sans text-gray-900">
              <div className="bg-slate-900 text-white p-4 shadow-md flex justify-between items-center z-10">
                <div className="flex items-center gap-2"><div className="bg-blue-500 p-2 rounded-lg"><Car className="w-6 h-6 text-white"/></div><div><h1 className="font-bold text-xl tracking-tight">LAVAMEX</h1><div className="text-xs text-blue-300">Rate: ${exchangeRate}</div></div></div>
                <div className="flex items-center gap-4">
                    {isOnline ? <Wifi className="w-4 h-4 text-green-400"/> : <WifiOff className="w-4 h-4 text-red-400"/>}
                    <div className="flex bg-slate-800 p-1 rounded-lg">
                      <button onClick={() => setView('GREETER')} className={`px-4 py-2 rounded-md flex gap-2 ${view==='GREETER'?'bg-blue-600':'text-gray-400'}`}><CheckCircle className="w-4 h-4"/> Entrada</button>
                      <button onClick={() => setView('CASHIER')} className={`px-4 py-2 rounded-md flex gap-2 ${view==='CASHIER'?'bg-blue-600':'text-gray-400'}`}><Calculator className="w-4 h-4"/> Caja</button>
                      <button onClick={() => setView('PAYROLL')} className={`px-4 py-2 rounded-md flex gap-2 ${view==='PAYROLL'?'bg-blue-600':'text-gray-400'}`}><Users className="w-4 h-4"/> Nómina</button>
                      <button onClick={() => setView('ADMIN')} className={`px-4 py-2 rounded-md ${view==='ADMIN'?'bg-blue-600':'text-gray-400'}`}><Settings className="w-4 h-4"/></button>
                    </div>
                </div>
              </div>
              <div className="flex-1 overflow-hidden">
                {view === 'GREETER' && <GreeterView employees={employees} selectedSize={selectedSize} setSelectedSize={setSelectedSize} selectedService={selectedService} setSelectedService={setSelectedService} selectedWashers={selectedWashers} setSelectedWashers={setSelectedWashers} selectedExtras={selectedExtras} setSelectedExtras={setSelectedExtras} vehicleDesc={vehicleDesc} setVehicleDesc={setVehicleDesc} createTicket={saveTicket} isEditing={!!editingTicketId} cancelEdit={cancelEdit} />}
                {view === 'CASHIER' && <CashierView tickets={tickets} activeTicketId={activeTicketId} setActiveTicketId={setActiveTicketId} paymentMxn={paymentMxn} setPaymentMxn={setPaymentMxn} paymentUsd={paymentUsd} setPaymentUsd={setPaymentUsd} exchangeRate={exchangeRate} processPayment={processPayment} deleteTicket={deleteTicket} startEdit={startEdit} updateTicketSnacks={updateTicketSnacks} employees={employees} addEmployeeDebt={addEmployeeDebt} />}
                {view === 'PAYROLL' && <PayrollView employees={employees} history={history} deductions={deductions} db={db} />}
                {view === 'ADMIN' && <AdminView isOnline={isOnline} db={db} exchangeRate={exchangeRate} setExchangeRate={setExchangeRate} employees={employees} setEmployees={setEmployees} history={history} />}
              </div>
            </div>
          );
        }
        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>